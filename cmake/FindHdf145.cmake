#
# Surcouche CEA/DAM : ajout des targets (en fin de fichier)
#
# Version du 12/08/22
#

#
# The module defines the following variables:
#  HDF145_FOUND - the system has HDF145
#  HDF145_INCLUDE_DIR - where to find HDF145/hdf5.h
#  HDF145_INCLUDE_DIRS - HDF145 includes
#  HDF145_LIBRARY - where to find the HDF145 library
#  HDF145CPP_LIBRARY - where to find the HDF145 C++ API library
#  HDF145_LIBRARIES - additional libraries
#  HDF145_MAJOR_VERSION - major version
#  HDF145_MINOR_VERSION - minor version
#  HDF145_PATCH_VERSION - patch version
#  HDF145_VERSION_STRING - version (ex. 5.2.1)
#  HDF145_ROOT_DIR - root dir

find_path (HDF145_INCLUDE_DIR NAMES HDF145/hdf5.h PATH_SUFFIXES HDF145)

if (HDF145_INCLUDE_DIR)
	set (HDF145_FOUND TRUE)
	if (NOT ZLIB_FOUND) 
		find_package (ZLIB REQUIRED)
	endif (NOT ZLIB_FOUND)
#	message( "HDF145_INCLUDE_DIR: '${HDF145_INCLUDE_DIR}'" )
	string (REGEX REPLACE "(.*)/include.*" "\\1" HDF145_ROOT_DIR ${HDF145_INCLUDE_DIR})
#	message( "HDF145_ROOT_DIR: '${HDF145_ROOT_DIR}'" )
	find_library (HDF145_LIBRARY NAMES hdf145 PATHS ${HDF145_ROOT_DIR} PATH_SUFFIXES lib lib64)
	find_library (HDF145CPP_LIBRARY NAMES hdf145_cpp PATHS ${HDF145_ROOT_DIR} PATH_SUFFIXES lib lib64)
#	message( "HDF145_LIBRARY: '${HDF145_LIBRARY}'" " HDF145CPP_LIBRARY: '${HDF145CPP_LIBRARY}'")


set (HDF145_INCLUDE_DIRS ${HDF145_INCLUDE_DIR})

# version
set (HDF145_MAJOR_VERSION "1")
set (HDF145_MINOR_VERSION "3")
set (HDF145_PATCH_VERSION "0")
set (HDF145_VERSION_STRING "1.3.0")

set (HDF145_LIBRARIES ${HDF145CPP_LIBRARY} ${HDF145_LIBRARY})

mark_as_advanced (
  HDF145_LIBRARY
  HDF145CPP_LIBRARY
  HDF145_LIBRARIES
  HDF145_INCLUDE_DIR
  HDF145_INCLUDE_DIRS
  HDF145_MAJOR_VERSION
  HDF145_MINOR_VERSION
  HDF145_PATCH_VERSION
  HDF145_VERSION_STRING
  HDF145_ROOT_DIR
)

if (NOT TARGET HDF145::hdf145_cpp)
	set (HDF145_TARGET "HDF145::hdf145")
	set (HDF145CPP_TARGET "HDF145::hdf145_cpp")

	add_library (${HDF145_TARGET} SHARED IMPORTED)
	add_library (${HDF145CPP_TARGET} SHARED IMPORTED)
	set_target_properties (HDF145::hdf145 PROPERTIES
		INTERFACE_INCLUDE_DIRECTORIES ${HDF145_INCLUDE_DIR}
		IMPORTED_LOCATION ${HDF145_LIBRARY}
		INTERFACE_LINK_LIBRARIES "${HDF145_LIBRARY};ZLIB::ZLIB"
	)
	set_target_properties (HDF145::hdf145_cpp PROPERTIES
		INTERFACE_INCLUDE_DIRECTORIES ${HDF145_INCLUDE_DIR}
		IMPORTED_LOCATION ${HDF145CPP_LIBRARY}
		INTERFACE_LINK_LIBRARIES "${HDF145CPP_LIBRARY};HDF145::hdf145"
	)
endif (NOT TARGET HDF145::hdf145_cpp)

endif (HDF145_INCLUDE_DIR)
